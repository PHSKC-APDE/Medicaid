/****** ALL ED visits, 2016  ******/
select count(*) 

	from (select distinct tcn, from_srvc_date
	--from (select distinct MEDICAID_RECIPIENT_ID
	--select distinct TCN, MEDICAID_RECIPIENT_ID,FROM_SRVC_DATE,REVENUE_CODE, PRCDR_CODE_1, PRCDR_CODE_2, PRCDR_CODE_3, PRCDR_CODE_4, PRCDR_CODE_5, PLACE_OF_SERVICE, PRIMARY_DIAGNOSIS_CODE
		from dbo.NewClaims
		where (FROM_SRVC_DATE BETWEEN '2016-01-01' AND '2016-12-31') 
  
		AND

		/*select ED visits using HEDIS ED value set or ED place of stay*/
		((REVENUE_CODE LIKE '045[01269]' OR REVENUE_CODE LIKE '0981' OR PRCDR_CODE_1 LIKE '9928[1-5]'
		OR PRCDR_CODE_2 LIKE '9928[1-5]' OR PRCDR_CODE_3 LIKE '9928[1-5]' OR PRCDR_CODE_4 LIKE '9928[1-5]' OR PRCDR_CODE_5 LIKE '9928[1-5]')
		OR (PLACE_OF_SERVICE LIKE '%23%')) 

	) as internalQuery

/****** ED visits due to oral health care, primary diagnosis field only  ******/
--select count(distinct tcn)
--Count distinct combinations of TCN and FROM_SRVC_DATE (same result as just TCN, but this is more careful)
select count(*) 

	from (select distinct tcn, from_srvc_date
	--from (select distinct MEDICAID_RECIPIENT_ID
	--select distinct TCN, MEDICAID_RECIPIENT_ID,FROM_SRVC_DATE,REVENUE_CODE, PRCDR_CODE_1, PRCDR_CODE_2, PRCDR_CODE_3, PRCDR_CODE_4, PRCDR_CODE_5, PLACE_OF_SERVICE, PRIMARY_DIAGNOSIS_CODE
		from dbo.NewClaims
		where (FROM_SRVC_DATE BETWEEN '2016-01-01' AND '2016-12-31') 
  
		AND

		/*select ED visits using HEDIS ED value set or ED place of stay*/
		((REVENUE_CODE LIKE '045[01269]' OR REVENUE_CODE LIKE '0981' OR PRCDR_CODE_1 LIKE '9928[1-5]'
		OR PRCDR_CODE_2 LIKE '9928[1-5]' OR PRCDR_CODE_3 LIKE '9928[1-5]' OR PRCDR_CODE_4 LIKE '9928[1-5]' OR PRCDR_CODE_5 LIKE '9928[1-5]')
		OR (PLACE_OF_SERVICE LIKE '%23%')) 

		AND

		/*select oral health claims using WSHA def, mapped to ICD-10*/
		(PRIMARY_DIAGNOSIS_CODE like 'K00[678]' OR PRIMARY_DIAGNOSIS_CODE like 'K01[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K026[123]'
		OR PRIMARY_DIAGNOSIS_CODE like 'K02[79]' OR PRIMARY_DIAGNOSIS_CODE like 'K03[12]' OR PRIMARY_DIAGNOSIS_CODE like 'K0381'
		OR PRIMARY_DIAGNOSIS_CODE like 'K04[0145678]' OR PRIMARY_DIAGNOSIS_CODE like 'K049[09]' 
		OR PRIMARY_DIAGNOSIS_CODE like 'K050[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K051[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K052[01]'
		OR PRIMARY_DIAGNOSIS_CODE like 'K0530' OR PRIMARY_DIAGNOSIS_CODE like 'K05[4-6]' OR PRIMARY_DIAGNOSIS_CODE like 'K06[0-2]'
		OR PRIMARY_DIAGNOSIS_CODE in ('K08109','K0820') OR PRIMARY_DIAGNOSIS_CODE like 'K084[0129]9' OR PRIMARY_DIAGNOSIS_CODE like 'K0850'
		OR PRIMARY_DIAGNOSIS_CODE like 'K0853[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K08[89]' OR PRIMARY_DIAGNOSIS_CODE like 'K090'
		OR PRIMARY_DIAGNOSIS_CODE like 'K12[12]' OR PRIMARY_DIAGNOSIS_CODE like 'K123[0139]' OR PRIMARY_DIAGNOSIS_CODE like 'K1329'
		OR PRIMARY_DIAGNOSIS_CODE like 'M2609' OR PRIMARY_DIAGNOSIS_CODE like 'M2610' OR PRIMARY_DIAGNOSIS_CODE like 'M263[034]'
		OR PRIMARY_DIAGNOSIS_CODE like 'M266[029]' OR PRIMARY_DIAGNOSIS_CODE like 'M2679' OR PRIMARY_DIAGNOSIS_CODE like 'M27[23]'
		OR PRIMARY_DIAGNOSIS_CODE like 'M2749' OR PRIMARY_DIAGNOSIS_CODE like 'M276[139]' OR PRIMARY_DIAGNOSIS_CODE like 'M27[89]')
		
	) as internalQuery
	 
	--order by FROM_SRVC_DATE


/****** ED visits due to oral health care, ALL diagnosis fields ******/
--select count(distinct tcn)
--Count distinct combinations of TCN and FROM_SRVC_DATE (same result as just TCN, but this is more careful)
select count(*) 

	--from (select distinct tcn, from_srvc_date
	from (select distinct MEDICAID_RECIPIENT_ID
	--select distinct TCN, MEDICAID_RECIPIENT_ID,FROM_SRVC_DATE,REVENUE_CODE, PRCDR_CODE_1, PRCDR_CODE_2, PRCDR_CODE_3, PRCDR_CODE_4, PRCDR_CODE_5, PLACE_OF_SERVICE, PRIMARY_DIAGNOSIS_CODE
		from dbo.NewClaims
		where (FROM_SRVC_DATE BETWEEN '2016-01-01' AND '2016-12-31') 
  
		AND

		/*select ED visits using HEDIS ED value set or ED place of stay*/
		((REVENUE_CODE LIKE '045[01269]' OR REVENUE_CODE LIKE '0981' OR PRCDR_CODE_1 LIKE '9928[1-5]'
		OR PRCDR_CODE_2 LIKE '9928[1-5]' OR PRCDR_CODE_3 LIKE '9928[1-5]' OR PRCDR_CODE_4 LIKE '9928[1-5]' OR PRCDR_CODE_5 LIKE '9928[1-5]')
		OR (PLACE_OF_SERVICE LIKE '%23%')) 

		AND

		(
		/*select oral health claims using WSHA def, mapped to ICD-10*/
		(PRIMARY_DIAGNOSIS_CODE like 'K00[678]' OR PRIMARY_DIAGNOSIS_CODE like 'K01[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K026[123]'
		OR PRIMARY_DIAGNOSIS_CODE like 'K02[79]' OR PRIMARY_DIAGNOSIS_CODE like 'K03[12]' OR PRIMARY_DIAGNOSIS_CODE like 'K0381'
		OR PRIMARY_DIAGNOSIS_CODE like 'K04[0145678]' OR PRIMARY_DIAGNOSIS_CODE like 'K049[09]' 
		OR PRIMARY_DIAGNOSIS_CODE like 'K050[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K051[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K052[01]'
		OR PRIMARY_DIAGNOSIS_CODE like 'K0530' OR PRIMARY_DIAGNOSIS_CODE like 'K05[4-6]' OR PRIMARY_DIAGNOSIS_CODE like 'K06[0-2]'
		OR PRIMARY_DIAGNOSIS_CODE in ('K08109','K0820') OR PRIMARY_DIAGNOSIS_CODE like 'K084[0129]9' OR PRIMARY_DIAGNOSIS_CODE like 'K0850'
		OR PRIMARY_DIAGNOSIS_CODE like 'K0853[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K08[89]' OR PRIMARY_DIAGNOSIS_CODE like 'K090'
		OR PRIMARY_DIAGNOSIS_CODE like 'K12[12]' OR PRIMARY_DIAGNOSIS_CODE like 'K123[0139]' OR PRIMARY_DIAGNOSIS_CODE like 'K1329'
		OR PRIMARY_DIAGNOSIS_CODE like 'M2609' OR PRIMARY_DIAGNOSIS_CODE like 'M2610' OR PRIMARY_DIAGNOSIS_CODE like 'M263[034]'
		OR PRIMARY_DIAGNOSIS_CODE like 'M266[029]' OR PRIMARY_DIAGNOSIS_CODE like 'M2679' OR PRIMARY_DIAGNOSIS_CODE like 'M27[23]'
		OR PRIMARY_DIAGNOSIS_CODE like 'M2749' OR PRIMARY_DIAGNOSIS_CODE like 'M276[139]' OR PRIMARY_DIAGNOSIS_CODE like 'M27[89]')

		OR

		(DIAGNOSIS_CODE_2 like 'K00[678]' OR DIAGNOSIS_CODE_2 like 'K01[01]' OR DIAGNOSIS_CODE_2 like 'K026[123]'
		OR DIAGNOSIS_CODE_2 like 'K02[79]' OR DIAGNOSIS_CODE_2 like 'K03[12]' OR DIAGNOSIS_CODE_2 like 'K0381'
		OR DIAGNOSIS_CODE_2 like 'K04[0145678]' OR DIAGNOSIS_CODE_2 like 'K049[09]' 
		OR DIAGNOSIS_CODE_2 like 'K050[01]' OR DIAGNOSIS_CODE_2 like 'K051[01]' OR DIAGNOSIS_CODE_2 like 'K052[01]'
		OR DIAGNOSIS_CODE_2 like 'K0530' OR DIAGNOSIS_CODE_2 like 'K05[4-6]' OR DIAGNOSIS_CODE_2 like 'K06[0-2]'
		OR DIAGNOSIS_CODE_2 in ('K08109','K0820') OR DIAGNOSIS_CODE_2 like 'K084[0129]9' OR DIAGNOSIS_CODE_2 like 'K0850'
		OR DIAGNOSIS_CODE_2 like 'K0853[01]' OR DIAGNOSIS_CODE_2 like 'K08[89]' OR DIAGNOSIS_CODE_2 like 'K090'
		OR DIAGNOSIS_CODE_2 like 'K12[12]' OR DIAGNOSIS_CODE_2 like 'K123[0139]' OR DIAGNOSIS_CODE_2 like 'K1329'
		OR DIAGNOSIS_CODE_2 like 'M2609' OR DIAGNOSIS_CODE_2 like 'M2610' OR DIAGNOSIS_CODE_2 like 'M263[034]'
		OR DIAGNOSIS_CODE_2 like 'M266[029]' OR DIAGNOSIS_CODE_2 like 'M2679' OR DIAGNOSIS_CODE_2 like 'M27[23]'
		OR DIAGNOSIS_CODE_2 like 'M2749' OR DIAGNOSIS_CODE_2 like 'M276[139]' OR DIAGNOSIS_CODE_2 like 'M27[89]')
		
		OR

		(DIAGNOSIS_CODE_3 like 'K00[678]' OR DIAGNOSIS_CODE_3 like 'K01[01]' OR DIAGNOSIS_CODE_3 like 'K026[123]'
		OR DIAGNOSIS_CODE_3 like 'K02[79]' OR DIAGNOSIS_CODE_3 like 'K03[12]' OR DIAGNOSIS_CODE_3 like 'K0381'
		OR DIAGNOSIS_CODE_3 like 'K04[0145678]' OR DIAGNOSIS_CODE_3 like 'K049[09]' 
		OR DIAGNOSIS_CODE_3 like 'K050[01]' OR DIAGNOSIS_CODE_3 like 'K051[01]' OR DIAGNOSIS_CODE_3 like 'K052[01]'
		OR DIAGNOSIS_CODE_3 like 'K0530' OR DIAGNOSIS_CODE_3 like 'K05[4-6]' OR DIAGNOSIS_CODE_3 like 'K06[0-2]'
		OR DIAGNOSIS_CODE_3 in ('K08109','K0820') OR DIAGNOSIS_CODE_3 like 'K084[0129]9' OR DIAGNOSIS_CODE_3 like 'K0850'
		OR DIAGNOSIS_CODE_3 like 'K0853[01]' OR DIAGNOSIS_CODE_3 like 'K08[89]' OR DIAGNOSIS_CODE_3 like 'K090'
		OR DIAGNOSIS_CODE_3 like 'K12[12]' OR DIAGNOSIS_CODE_3 like 'K123[0139]' OR DIAGNOSIS_CODE_3 like 'K1329'
		OR DIAGNOSIS_CODE_3 like 'M2609' OR DIAGNOSIS_CODE_3 like 'M2610' OR DIAGNOSIS_CODE_3 like 'M263[034]'
		OR DIAGNOSIS_CODE_3 like 'M266[029]' OR DIAGNOSIS_CODE_3 like 'M2679' OR DIAGNOSIS_CODE_3 like 'M27[23]'
		OR DIAGNOSIS_CODE_3 like 'M2749' OR DIAGNOSIS_CODE_3 like 'M276[139]' OR DIAGNOSIS_CODE_3 like 'M27[89]')
		
		OR

		(DIAGNOSIS_CODE_4 like 'K00[678]' OR DIAGNOSIS_CODE_4 like 'K01[01]' OR DIAGNOSIS_CODE_4 like 'K026[123]'
		OR DIAGNOSIS_CODE_4 like 'K02[79]' OR DIAGNOSIS_CODE_4 like 'K03[12]' OR DIAGNOSIS_CODE_4 like 'K0381'
		OR DIAGNOSIS_CODE_4 like 'K04[0145678]' OR DIAGNOSIS_CODE_4 like 'K049[09]' 
		OR DIAGNOSIS_CODE_4 like 'K050[01]' OR DIAGNOSIS_CODE_4 like 'K051[01]' OR DIAGNOSIS_CODE_4 like 'K052[01]'
		OR DIAGNOSIS_CODE_4 like 'K0530' OR DIAGNOSIS_CODE_4 like 'K05[4-6]' OR DIAGNOSIS_CODE_4 like 'K06[0-2]'
		OR DIAGNOSIS_CODE_4 in ('K08109','K0820') OR DIAGNOSIS_CODE_4 like 'K084[0129]9' OR DIAGNOSIS_CODE_4 like 'K0850'
		OR DIAGNOSIS_CODE_4 like 'K0853[01]' OR DIAGNOSIS_CODE_4 like 'K08[89]' OR DIAGNOSIS_CODE_4 like 'K090'
		OR DIAGNOSIS_CODE_4 like 'K12[12]' OR DIAGNOSIS_CODE_4 like 'K123[0139]' OR DIAGNOSIS_CODE_4 like 'K1329'
		OR DIAGNOSIS_CODE_4 like 'M2609' OR DIAGNOSIS_CODE_4 like 'M2610' OR DIAGNOSIS_CODE_4 like 'M263[034]'
		OR DIAGNOSIS_CODE_4 like 'M266[029]' OR DIAGNOSIS_CODE_4 like 'M2679' OR DIAGNOSIS_CODE_4 like 'M27[23]'
		OR DIAGNOSIS_CODE_4 like 'M2749' OR DIAGNOSIS_CODE_4 like 'M276[139]' OR DIAGNOSIS_CODE_4 like 'M27[89]')
		
		OR

		(DIAGNOSIS_CODE_5 like 'K00[678]' OR DIAGNOSIS_CODE_5 like 'K01[01]' OR DIAGNOSIS_CODE_5 like 'K026[123]'
		OR DIAGNOSIS_CODE_5 like 'K02[79]' OR DIAGNOSIS_CODE_5 like 'K03[12]' OR DIAGNOSIS_CODE_5 like 'K0381'
		OR DIAGNOSIS_CODE_5 like 'K04[0145678]' OR DIAGNOSIS_CODE_5 like 'K049[09]' 
		OR DIAGNOSIS_CODE_5 like 'K050[01]' OR DIAGNOSIS_CODE_5 like 'K051[01]' OR DIAGNOSIS_CODE_5 like 'K052[01]'
		OR DIAGNOSIS_CODE_5 like 'K0530' OR DIAGNOSIS_CODE_5 like 'K05[4-6]' OR DIAGNOSIS_CODE_5 like 'K06[0-2]'
		OR DIAGNOSIS_CODE_5 in ('K08109','K0820') OR DIAGNOSIS_CODE_5 like 'K084[0129]9' OR DIAGNOSIS_CODE_5 like 'K0850'
		OR DIAGNOSIS_CODE_5 like 'K0853[01]' OR DIAGNOSIS_CODE_5 like 'K08[89]' OR DIAGNOSIS_CODE_5 like 'K090'
		OR DIAGNOSIS_CODE_5 like 'K12[12]' OR DIAGNOSIS_CODE_5 like 'K123[0139]' OR DIAGNOSIS_CODE_5 like 'K1329'
		OR DIAGNOSIS_CODE_5 like 'M2609' OR DIAGNOSIS_CODE_5 like 'M2610' OR DIAGNOSIS_CODE_5 like 'M263[034]'
		OR DIAGNOSIS_CODE_5 like 'M266[029]' OR DIAGNOSIS_CODE_5 like 'M2679' OR DIAGNOSIS_CODE_5 like 'M27[23]'
		OR DIAGNOSIS_CODE_5 like 'M2749' OR DIAGNOSIS_CODE_5 like 'M276[139]' OR DIAGNOSIS_CODE_5 like 'M27[89]')
		)
	) as internalQuery
	 
	--order by FROM_SRVC_DATE


/****** Billing providers for ED visits due to oral health care, ALL diagnosis fields ******/
select BILLING_PRVDR_ADDRESS, count(*)

from (select distinct TCN,MEDICAID_RECIPIENT_ID,FROM_SRVC_DATE,BLNG_NATIONAL_PRVDR_IDNTFR,BILLING_PRVDR_ADDRESS,SRVCNG_NATIONAL_PRVDR_IDNTFR,REVENUE_CODE, PRCDR_CODE_1, PRCDR_CODE_2, PRCDR_CODE_3, PRCDR_CODE_4, PRCDR_CODE_5, PLACE_OF_SERVICE, PRIMARY_DIAGNOSIS_CODE
from dbo.NewClaims
where (FROM_SRVC_DATE BETWEEN '2016-01-01' AND '2016-12-31') 
  
AND

/*select ED visits using HEDIS ED value set or ED place of stay*/
((REVENUE_CODE LIKE '045[01269]' OR REVENUE_CODE LIKE '0981' OR PRCDR_CODE_1 LIKE '9928[1-5]'
OR PRCDR_CODE_2 LIKE '9928[1-5]' OR PRCDR_CODE_3 LIKE '9928[1-5]' OR PRCDR_CODE_4 LIKE '9928[1-5]' OR PRCDR_CODE_5 LIKE '9928[1-5]')
OR (PLACE_OF_SERVICE LIKE '%23%')) 

AND

(
/*select oral health claims using WSHA def, mapped to ICD-10*/
(PRIMARY_DIAGNOSIS_CODE like 'K00[678]' OR PRIMARY_DIAGNOSIS_CODE like 'K01[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K026[123]'
OR PRIMARY_DIAGNOSIS_CODE like 'K02[79]' OR PRIMARY_DIAGNOSIS_CODE like 'K03[12]' OR PRIMARY_DIAGNOSIS_CODE like 'K0381'
OR PRIMARY_DIAGNOSIS_CODE like 'K04[0145678]' OR PRIMARY_DIAGNOSIS_CODE like 'K049[09]' 
OR PRIMARY_DIAGNOSIS_CODE like 'K050[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K051[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K052[01]'
OR PRIMARY_DIAGNOSIS_CODE like 'K0530' OR PRIMARY_DIAGNOSIS_CODE like 'K05[4-6]' OR PRIMARY_DIAGNOSIS_CODE like 'K06[0-2]'
OR PRIMARY_DIAGNOSIS_CODE in ('K08109','K0820') OR PRIMARY_DIAGNOSIS_CODE like 'K084[0129]9' OR PRIMARY_DIAGNOSIS_CODE like 'K0850'
OR PRIMARY_DIAGNOSIS_CODE like 'K0853[01]' OR PRIMARY_DIAGNOSIS_CODE like 'K08[89]' OR PRIMARY_DIAGNOSIS_CODE like 'K090'
OR PRIMARY_DIAGNOSIS_CODE like 'K12[12]' OR PRIMARY_DIAGNOSIS_CODE like 'K123[0139]' OR PRIMARY_DIAGNOSIS_CODE like 'K1329'
OR PRIMARY_DIAGNOSIS_CODE like 'M2609' OR PRIMARY_DIAGNOSIS_CODE like 'M2610' OR PRIMARY_DIAGNOSIS_CODE like 'M263[034]'
OR PRIMARY_DIAGNOSIS_CODE like 'M266[029]' OR PRIMARY_DIAGNOSIS_CODE like 'M2679' OR PRIMARY_DIAGNOSIS_CODE like 'M27[23]'
OR PRIMARY_DIAGNOSIS_CODE like 'M2749' OR PRIMARY_DIAGNOSIS_CODE like 'M276[139]' OR PRIMARY_DIAGNOSIS_CODE like 'M27[89]')

OR

(DIAGNOSIS_CODE_2 like 'K00[678]' OR DIAGNOSIS_CODE_2 like 'K01[01]' OR DIAGNOSIS_CODE_2 like 'K026[123]'
OR DIAGNOSIS_CODE_2 like 'K02[79]' OR DIAGNOSIS_CODE_2 like 'K03[12]' OR DIAGNOSIS_CODE_2 like 'K0381'
OR DIAGNOSIS_CODE_2 like 'K04[0145678]' OR DIAGNOSIS_CODE_2 like 'K049[09]' 
OR DIAGNOSIS_CODE_2 like 'K050[01]' OR DIAGNOSIS_CODE_2 like 'K051[01]' OR DIAGNOSIS_CODE_2 like 'K052[01]'
OR DIAGNOSIS_CODE_2 like 'K0530' OR DIAGNOSIS_CODE_2 like 'K05[4-6]' OR DIAGNOSIS_CODE_2 like 'K06[0-2]'
OR DIAGNOSIS_CODE_2 in ('K08109','K0820') OR DIAGNOSIS_CODE_2 like 'K084[0129]9' OR DIAGNOSIS_CODE_2 like 'K0850'
OR DIAGNOSIS_CODE_2 like 'K0853[01]' OR DIAGNOSIS_CODE_2 like 'K08[89]' OR DIAGNOSIS_CODE_2 like 'K090'
OR DIAGNOSIS_CODE_2 like 'K12[12]' OR DIAGNOSIS_CODE_2 like 'K123[0139]' OR DIAGNOSIS_CODE_2 like 'K1329'
OR DIAGNOSIS_CODE_2 like 'M2609' OR DIAGNOSIS_CODE_2 like 'M2610' OR DIAGNOSIS_CODE_2 like 'M263[034]'
OR DIAGNOSIS_CODE_2 like 'M266[029]' OR DIAGNOSIS_CODE_2 like 'M2679' OR DIAGNOSIS_CODE_2 like 'M27[23]'
OR DIAGNOSIS_CODE_2 like 'M2749' OR DIAGNOSIS_CODE_2 like 'M276[139]' OR DIAGNOSIS_CODE_2 like 'M27[89]')
		
OR

(DIAGNOSIS_CODE_3 like 'K00[678]' OR DIAGNOSIS_CODE_3 like 'K01[01]' OR DIAGNOSIS_CODE_3 like 'K026[123]'
OR DIAGNOSIS_CODE_3 like 'K02[79]' OR DIAGNOSIS_CODE_3 like 'K03[12]' OR DIAGNOSIS_CODE_3 like 'K0381'
OR DIAGNOSIS_CODE_3 like 'K04[0145678]' OR DIAGNOSIS_CODE_3 like 'K049[09]' 
OR DIAGNOSIS_CODE_3 like 'K050[01]' OR DIAGNOSIS_CODE_3 like 'K051[01]' OR DIAGNOSIS_CODE_3 like 'K052[01]'
OR DIAGNOSIS_CODE_3 like 'K0530' OR DIAGNOSIS_CODE_3 like 'K05[4-6]' OR DIAGNOSIS_CODE_3 like 'K06[0-2]'
OR DIAGNOSIS_CODE_3 in ('K08109','K0820') OR DIAGNOSIS_CODE_3 like 'K084[0129]9' OR DIAGNOSIS_CODE_3 like 'K0850'
OR DIAGNOSIS_CODE_3 like 'K0853[01]' OR DIAGNOSIS_CODE_3 like 'K08[89]' OR DIAGNOSIS_CODE_3 like 'K090'
OR DIAGNOSIS_CODE_3 like 'K12[12]' OR DIAGNOSIS_CODE_3 like 'K123[0139]' OR DIAGNOSIS_CODE_3 like 'K1329'
OR DIAGNOSIS_CODE_3 like 'M2609' OR DIAGNOSIS_CODE_3 like 'M2610' OR DIAGNOSIS_CODE_3 like 'M263[034]'
OR DIAGNOSIS_CODE_3 like 'M266[029]' OR DIAGNOSIS_CODE_3 like 'M2679' OR DIAGNOSIS_CODE_3 like 'M27[23]'
OR DIAGNOSIS_CODE_3 like 'M2749' OR DIAGNOSIS_CODE_3 like 'M276[139]' OR DIAGNOSIS_CODE_3 like 'M27[89]')
		
OR

(DIAGNOSIS_CODE_4 like 'K00[678]' OR DIAGNOSIS_CODE_4 like 'K01[01]' OR DIAGNOSIS_CODE_4 like 'K026[123]'
OR DIAGNOSIS_CODE_4 like 'K02[79]' OR DIAGNOSIS_CODE_4 like 'K03[12]' OR DIAGNOSIS_CODE_4 like 'K0381'
OR DIAGNOSIS_CODE_4 like 'K04[0145678]' OR DIAGNOSIS_CODE_4 like 'K049[09]' 
OR DIAGNOSIS_CODE_4 like 'K050[01]' OR DIAGNOSIS_CODE_4 like 'K051[01]' OR DIAGNOSIS_CODE_4 like 'K052[01]'
OR DIAGNOSIS_CODE_4 like 'K0530' OR DIAGNOSIS_CODE_4 like 'K05[4-6]' OR DIAGNOSIS_CODE_4 like 'K06[0-2]'
OR DIAGNOSIS_CODE_4 in ('K08109','K0820') OR DIAGNOSIS_CODE_4 like 'K084[0129]9' OR DIAGNOSIS_CODE_4 like 'K0850'
OR DIAGNOSIS_CODE_4 like 'K0853[01]' OR DIAGNOSIS_CODE_4 like 'K08[89]' OR DIAGNOSIS_CODE_4 like 'K090'
OR DIAGNOSIS_CODE_4 like 'K12[12]' OR DIAGNOSIS_CODE_4 like 'K123[0139]' OR DIAGNOSIS_CODE_4 like 'K1329'
OR DIAGNOSIS_CODE_4 like 'M2609' OR DIAGNOSIS_CODE_4 like 'M2610' OR DIAGNOSIS_CODE_4 like 'M263[034]'
OR DIAGNOSIS_CODE_4 like 'M266[029]' OR DIAGNOSIS_CODE_4 like 'M2679' OR DIAGNOSIS_CODE_4 like 'M27[23]'
OR DIAGNOSIS_CODE_4 like 'M2749' OR DIAGNOSIS_CODE_4 like 'M276[139]' OR DIAGNOSIS_CODE_4 like 'M27[89]')
		
OR

(DIAGNOSIS_CODE_5 like 'K00[678]' OR DIAGNOSIS_CODE_5 like 'K01[01]' OR DIAGNOSIS_CODE_5 like 'K026[123]'
OR DIAGNOSIS_CODE_5 like 'K02[79]' OR DIAGNOSIS_CODE_5 like 'K03[12]' OR DIAGNOSIS_CODE_5 like 'K0381'
OR DIAGNOSIS_CODE_5 like 'K04[0145678]' OR DIAGNOSIS_CODE_5 like 'K049[09]' 
OR DIAGNOSIS_CODE_5 like 'K050[01]' OR DIAGNOSIS_CODE_5 like 'K051[01]' OR DIAGNOSIS_CODE_5 like 'K052[01]'
OR DIAGNOSIS_CODE_5 like 'K0530' OR DIAGNOSIS_CODE_5 like 'K05[4-6]' OR DIAGNOSIS_CODE_5 like 'K06[0-2]'
OR DIAGNOSIS_CODE_5 in ('K08109','K0820') OR DIAGNOSIS_CODE_5 like 'K084[0129]9' OR DIAGNOSIS_CODE_5 like 'K0850'
OR DIAGNOSIS_CODE_5 like 'K0853[01]' OR DIAGNOSIS_CODE_5 like 'K08[89]' OR DIAGNOSIS_CODE_5 like 'K090'
OR DIAGNOSIS_CODE_5 like 'K12[12]' OR DIAGNOSIS_CODE_5 like 'K123[0139]' OR DIAGNOSIS_CODE_5 like 'K1329'
OR DIAGNOSIS_CODE_5 like 'M2609' OR DIAGNOSIS_CODE_5 like 'M2610' OR DIAGNOSIS_CODE_5 like 'M263[034]'
OR DIAGNOSIS_CODE_5 like 'M266[029]' OR DIAGNOSIS_CODE_5 like 'M2679' OR DIAGNOSIS_CODE_5 like 'M27[23]'
OR DIAGNOSIS_CODE_5 like 'M2749' OR DIAGNOSIS_CODE_5 like 'M276[139]' OR DIAGNOSIS_CODE_5 like 'M27[89]')
)
) as internalQuery
group by BILLING_PRVDR_ADDRESS

--order by TCN



select count(distinct tcn), ADMSN_SOURCE_NAME
--from (select distinct MEDICAID_RECIPIENT_ID
--select distinct TCN, MEDICAID_RECIPIENT_ID,FROM_SRVC_DATE,REVENUE_CODE, PRCDR_CODE_1, PRCDR_CODE_2, PRCDR_CODE_3, PRCDR_CODE_4, PRCDR_CODE_5, PLACE_OF_SERVICE, PRIMARY_DIAGNOSIS_CODE
	from dbo.NewClaims
	where (FROM_SRVC_DATE BETWEEN '2016-01-01' AND '2016-12-31') 
  
	AND

	/*select ED visits using HEDIS ED value set or ED place of stay*/
	((REVENUE_CODE LIKE '045[01269]' OR REVENUE_CODE LIKE '0981' OR PRCDR_CODE_1 LIKE '9928[1-5]'
	OR PRCDR_CODE_2 LIKE '9928[1-5]' OR PRCDR_CODE_3 LIKE '9928[1-5]' OR PRCDR_CODE_4 LIKE '9928[1-5]' OR PRCDR_CODE_5 LIKE '9928[1-5]')
	OR (PLACE_OF_SERVICE LIKE '%23%'))    
	
	group by ADMSN_SOURCE_NAME   